import{sleep as s,elementIsExistWithLog as i}from"./general.js";export var ToggleTabsEvent=(e=>(e[e.Click=0]="Click",e[e.Hover=1]="Hover",e))(ToggleTabsEvent||{});export default class o{constructor(t){this.isToggling=!1;this.autoHeight=!1;this.toggleTabsEvent="click";this.containerheight=0;this.buttonsActiveClass="active";this.contentActiveClass="active";if(!i("Tab",t.btnsSelector,t.contentBlocksSelector))return;if(this.buttons=document.querySelectorAll(t.btnsSelector),this.contentElements=document.querySelectorAll(t.contentBlocksSelector),this.buttons.length!=this.contentElements.length){console.error("[Tab] The count of buttons and content-elements is not equal.");return}t.buttonsActiveClass&&(this.buttonsActiveClass=t.buttonsActiveClass),t.contentActiveClass&&(this.contentActiveClass=t.contentActiveClass),(t.firstButtonIsNotActive==null||t.firstButtonIsNotActive==!1)&&this.buttons[0].classList.add(this.buttonsActiveClass),this.contentElements[0].classList.add(this.contentActiveClass),t.autoHeight&&(this.autoHeight=t.autoHeight);let e=document.querySelector(t.contentBlocksSelector);if(this.parentOfContentElements=e.parentElement,t.animationDuration?this.animationDuration=t.animationDuration:this.animationDuration=parseFloat(getComputedStyle(e).getPropertyValue("transition-duration"))*1e3,this.switchingLockTime=this.animationDuration,this.setToggleTabsEvent(t.toggleTabsBy),t.fadeEffect){this.setFadeTabs(),window.addEventListener("resize",this.resizeFadeTabs.bind(this));for(let n of this.buttons)n.addEventListener(this.toggleTabsEvent,()=>this.toggleTabsFade(n))}else{this.setDefaultTabs(),window.addEventListener("resize",this.resizeTabs.bind(this));for(let n of this.buttons)n.addEventListener(this.toggleTabsEvent,()=>this.toggleTabs(n))}}setFadeTabs(){let t=0;for(let e of this.contentElements)!this.autoHeight&&e.clientHeight>this.containerheight?this.containerheight=e.clientHeight:this.autoHeight&&this.containerheight<=0&&(this.containerheight=this.contentElements[0].clientHeight),e.classList.contains(this.contentActiveClass)==!1&&(e.style.opacity="0",e.style.pointerEvents="none"),e.style.transform=`translateY(-${t}px)`,t+=e.clientHeight;this.parentOfContentElements.style.display="flex",this.parentOfContentElements.style.flexDirection="column",this.parentOfContentElements.style.overflow="hidden",this.setContainerHeight(this.containerheight),this.parentOfContentElements.style.transition=`height ${this.animationDuration}ms`;for(let e of this.contentElements)e.style.transition=`opacity ${this.animationDuration}ms`}setDefaultTabs(){for(let t of this.contentElements)t.classList.contains(this.contentActiveClass)==!1&&(t.setAttribute("hidden",""),t.style.display="none",t.style.opacity="0",t.style.pointerEvents="none"),t.style.transition=`opacity ${this.animationDuration}ms`,this.setContainerHeight(),this.parentOfContentElements.style.transition=`height ${this.animationDuration}ms`}resizeFadeTabs(){let t=this.getCurrentActiveTab(),e=0;t?this.parentOfContentElements.style.height=`${t.clientHeight}px`:this.parentOfContentElements.style.height=`${this.contentElements[0].clientHeight}px`;for(let n of this.contentElements)n.style.transform=`translateY(-${e}px)`,e+=n.clientHeight}resizeTabs(){let t=this.getCurrentActiveTab();t?this.parentOfContentElements.style.height=`${t.clientHeight}px`:this.parentOfContentElements.style.height=`${this.contentElements[0].clientHeight}px`}toggleTabsFade(t){if(this.toggleTogglingStateIfPossible(t)==!1)return;this.toggleTabButtons(t);let e=this.getCurrentActiveTab(),n=this.getTabByPressedButton(t);e.style.opacity="0",e.style.pointerEvents="none",this.autoHeight&&this.setContainerHeight(n.clientHeight),n.style.opacity="1",n.style.removeProperty("pointer-events"),e.classList.remove(this.contentActiveClass),n.classList.add(this.contentActiveClass),setTimeout(()=>{this.isToggling=!1},this.switchingLockTime)}async toggleTabs(t){if(this.toggleTogglingStateIfPossible(t)==!1)return;this.toggleTabButtons(t);let e=this.getCurrentActiveTab(),n=this.getTabByPressedButton(t);e.classList.remove(this.contentActiveClass),e.style.opacity="0",e.style.pointerEvents="none",await s(this.animationDuration),e.setAttribute("hidden",""),e.style.display="none",n.removeAttribute("hidden"),n.style.removeProperty("pointer-events"),n.style.display="",this.setContainerHeight(n.clientHeight),await s(20),n.style.opacity="1",n.classList.add(this.contentActiveClass),setTimeout(()=>{this.isToggling=!1},this.switchingLockTime)}toggleTabButtons(t){for(let e of this.buttons)e!=t?e.classList.remove(this.buttonsActiveClass):e.classList.add(this.buttonsActiveClass)}toggleTogglingStateIfPossible(t){return t.classList.contains(this.buttonsActiveClass)||this.isToggling?!1:(this.isToggling=!0,!0)}getCurrentActiveTab(){for(let t of this.contentElements)if(t.classList.contains(this.contentActiveClass))return t;return this.contentElements[0]}getTabByPressedButton(t){return this.contentElements[t.dataset.toggleElemNumber]}setContainerHeight(t){t?this.parentOfContentElements.style.height=`${t}px`:this.parentOfContentElements.style.height=`${this.contentElements[0].clientHeight}px`}setToggleTabsEvent(t){switch(t){case 1:this.toggleTabsEvent="mouseenter",this.switchingLockTime=0;break;default:this.toggleTabsEvent="click";break}}}
